{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container py-4">
  <h2 class="text-primary mb-4">Available Document Templates</h2>

  <div class="d-flex justify-content-start align-items-center mb-3 gap-2">
    <a href="{% url 'docgen:upload-template' %}" class="btn btn-success">
      <i class="fa fa-upload"></i> Upload New Template
    </a>

    {# show PDF tools button only to users with the timesheet.can_approve permission #}
    {% if user.is_authenticated and perms.timesheet.can_approve %}
      <a href="{% url 'docgen:combined-pdf-tools' %}" class="btn btn-primary">
        <i class="fa fa-file-pdf-o"></i> PDF â†’ Word / Combine PDFs
      </a>
    {% endif %}
  </div>

  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags|default:'info' }}">{{ message }}</div>
    {% endfor %}
  {% endif %}

  {% if templates %}
  <table class="table table-bordered table-hover">
    <thead class="table-light">
      <tr>
        <th>#</th>
        <th>Name</th>
        <th>Description</th>
        <th>Uploaded File</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for template in templates %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ template.name }}</td>
        <td>{{ template.description|default:"-" }}</td>
        <td><a href="{{ template.template_file.url }}" target="_blank">View</a></td>
        <td>
          <a href="{% url 'docgen:fill-template' template.id %}" class="btn btn-sm btn-primary">
            Fill &amp; Generate
          </a>
          <a href="{% url 'docgen:delete-template' template.id %}" class="btn btn-sm btn-danger"
             onclick="return confirm('Are you sure you want to delete this template?');">
            Delete
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>No templates uploaded yet.</p>
  {% endif %}
</div>
{% endblock %}
