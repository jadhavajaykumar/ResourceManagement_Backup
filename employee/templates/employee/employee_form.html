{% extends "base.html" %}
{% load widget_tweaks %} {# optional - if you don't have widget_tweaks remove usage below #}

{% block title %}{% if editing %}Edit Employee{% else %}Add Employee{% endif %}{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="card shadow-sm">
    <div class="card-header bg-white">
      <h3 class="mb-0">{% if editing %}Edit Employee Profile{% else %}Add Employee{% endif %}</h3>
      <small class="text-muted">Use this form to create or update an employee profile. Link an existing user account or create a user first via Admin.</small>
    </div>
    <form method="post" novalidate>
      {% csrf_token %}
      <div class="card-body">
        <!-- PERSONAL DETAILS -->
        <h5 class="mb-3">Personal Details</h5>
        <div class="row g-3 mb-4">
          <div class="col-md-4">
            <label class="form-label">Linked User</label>
            {{ form.user }}
            {% if form.user.help_text %}<div class="form-text">{{ form.user.help_text }}</div>{% endif %}
            {% if form.user.errors %}<div class="text-danger small">{{ form.user.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">Employee ID</label>
            {{ form.employee_id }}
            <div class="form-text">Leave blank to auto-generate.</div>
            {% if form.employee_id.errors %}<div class="text-danger small">{{ form.employee_id.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">Role</label>
            {{ form.role }}
            {% if form.role.errors %}<div class="text-danger small">{{ form.role.errors }}</div>{% endif %}
          </div>

          <div class="col-md-4">
            <label class="form-label">Date of Birth</label>
            {{ form.date_of_birth }}
            {% if form.date_of_birth.errors %}<div class="text-danger small">{{ form.date_of_birth.errors }}</div>{% endif %}
          </div>

          <div class="col-md-4">
            <label class="form-label">Contact Number</label>
            {{ form.contact_number }}
            {% if form.contact_number.errors %}<div class="text-danger small">{{ form.contact_number.errors }}</div>{% endif %}
          </div>

          <div class="col-md-4">
            <label class="form-label">Department</label>
            {{ form.department }}
            {% if form.department.errors %}<div class="text-danger small">{{ form.department.errors }}</div>{% endif %}
          </div>

          <div class="col-12">
            <label class="form-label">Address</label>
            {{ form.address }}
            {% if form.address.errors %}<div class="text-danger small">{{ form.address.errors }}</div>{% endif %}
          </div>
        </div>

        <!-- EMPLOYMENT DETAILS -->
        <h5 class="mb-3">Employment Details</h5>
        <div class="row g-3 mb-4">
          <div class="col-md-4">
            <label class="form-label">Reporting Manager</label>
            {{ form.reporting_manager }}
            {% if form.reporting_manager.errors %}<div class="text-danger small">{{ form.reporting_manager.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">Employment Type</label>
            {{ form.employment_type }}
            {% if form.employment_type.errors %}<div class="text-danger small">{{ form.employment_type.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">Career Start Date</label>
            {{ form.career_start_date }}
            {% if form.career_start_date.errors %}<div class="text-danger small">{{ form.career_start_date.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">Probotix Joining Date</label>
            {{ form.probotix_joining_date }}
            {% if form.probotix_joining_date.errors %}<div class="text-danger small">{{ form.probotix_joining_date.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">Confirmation Date</label>
            {{ form.confirmation_date }}
            {% if form.confirmation_date.errors %}<div class="text-danger small">{{ form.confirmation_date.errors }}</div>{% endif %}
          </div>
        </div>

        <!-- EMERGENCY CONTACT -->
        <h5 class="mb-3">Emergency Contact</h5>
        <div class="row g-3 mb-4">
          <div class="col-md-4">
            <label class="form-label">Name</label>
            {{ form.emergency_contact_name }}
            {% if form.emergency_contact_name.errors %}<div class="text-danger small">{{ form.emergency_contact_name.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">Relation</label>
            {{ form.emergency_contact_relation }}
            {% if form.emergency_contact_relation.errors %}<div class="text-danger small">{{ form.emergency_contact_relation.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">Phone</label>
            {{ form.emergency_contact_number }}
            {% if form.emergency_contact_number.errors %}<div class="text-danger small">{{ form.emergency_contact_number.errors }}</div>{% endif %}
          </div>
        </div>

        <!-- BANK & LEGAL -->
        <h5 class="mb-3">Bank & Legal</h5>
        <div class="row g-3 mb-4">
          <div class="col-md-4">
            <label class="form-label">PAN/AADHAR/SSN</label>
            {{ form.pan_aadhar_ssn }}
            {% if form.pan_aadhar_ssn.errors %}<div class="text-danger small">{{ form.pan_aadhar_ssn.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">Bank Account</label>
            {{ form.bank_account_number }}
            {% if form.bank_account_number.errors %}<div class="text-danger small">{{ form.bank_account_number.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">IFSC / SWIFT</label>
            {{ form.bank_ifsc_code }}
            {% if form.bank_ifsc_code.errors %}<div class="text-danger small">{{ form.bank_ifsc_code.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">EPF Number</label>
            {{ form.epf_number }}
            {% if form.epf_number.errors %}<div class="text-danger small">{{ form.epf_number.errors }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label">Grace Period (days)</label>
            {{ form.grace_period_days }}
            {% if form.grace_period_days.errors %}<div class="text-danger small">{{ form.grace_period_days.errors }}</div>{% endif %}
          </div>
        </div>

      </div>
	  <div class="mb-3">
        <a href="{% url 'employee:export-template' %}" class="btn btn-link me-2">Download Employee Template</a>
        <a href="{% url 'employee:import-employees' %}" class="btn btn-link">Import Employees</a>
      </div>

      <div class="card-footer text-end bg-white">
        <a href="{% url 'employee:employee-list' %}" class="btn btn-secondary me-2">Cancel</a>
        <button type="submit" class="btn btn-primary">{% if editing %}Save Changes{% else %}Create Employee{% endif %}</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
